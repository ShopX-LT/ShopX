import React, { useState, useEffect } from "react";
import { useDispatch } from "react-redux";
import { getItem } from "../services/ItemService";
import useStyle from "../hooks/useStyle";
import { decreaseItemCount, increaseItemCount } from "../state";
import { fCurrency } from "../utils/formatNumber";

const CheckoutItem = ({ id, quantity }) => {
  const { style } = useStyle();
  const dispatch = useDispatch();

  const [item, setItem] = useState({});

  const increaseCount = () => {
    dispatch(increaseItemCount({ id: id }));
  };
  const decreaseCount = () => {
    dispatch(decreaseItemCount({ id: id }));
  };

  useEffect(() => {
    const retrieveItem = async () => {
      const response = await getItem({ id });
      if (!response) {
        setItem({});
        return;
      }
      setItem(response);
      console.log(item, id);
    };
    retrieveItem();
  }, []);

  return (
    <div className="p-2 flex flex-row justify-between items-center rounded-md shadow-md border-2 ">
      <div className="flex flex-row justify-start items-center gap-6">
        {/* <img
          src={item?.imagesUrl[0]}
          alt={`${item.title} image`}
          className="rounded w-[100px] h-[100px]"
        /> */}
        <div className="flex flex-col gap-3">
          <p className={`${style.heading2}`}>{item.title}</p>
          <div className="flex flex-row gap-3">
            <button onClick={decreaseCount}>
              <svg width="25" height="25" fill="none">
                <path
                  d="M8.33325 11.4583C8.05698 11.4583 7.79203 11.5681 7.59668 11.7634C7.40133 11.9588 7.29159 12.2237 7.29159 12.5C7.29159 12.7763 7.40133 13.0412 7.59668 13.2366C7.79203 13.4319 8.05698 13.5417 8.33325 13.5417H16.6666C16.9429 13.5417 17.2078 13.4319 17.4032 13.2366C17.5985 13.0412 17.7083 12.7763 17.7083 12.5C17.7083 12.2237 17.5985 11.9588 17.4032 11.7634C17.2078 11.5681 16.9429 11.4583 16.6666 11.4583H8.33325ZM12.4999 2.08334C9.73725 2.08334 7.08773 3.18081 5.13422 5.13431C3.18072 7.08782 2.08325 9.73734 2.08325 12.5C2.08325 15.2627 3.18072 17.9122 5.13422 19.8657C7.08773 21.8192 9.73725 22.9167 12.4999 22.9167C15.2626 22.9167 17.9121 21.8192 19.8656 19.8657C21.8191 17.9122 22.9166 15.2627 22.9166 12.5C22.9166 9.73734 21.8191 7.08782 19.8656 5.13431C17.9121 3.18081 15.2626 2.08334 12.4999 2.08334ZM4.16659 12.5C4.16659 10.2899 5.04456 8.17026 6.60736 6.60745C8.17017 5.04465 10.2898 4.16668 12.4999 4.16668C14.7101 4.16668 16.8297 5.04465 18.3925 6.60745C19.9553 8.17026 20.8333 10.2899 20.8333 12.5C20.8333 14.7101 19.9553 16.8298 18.3925 18.3926C16.8297 19.9554 14.7101 20.8333 12.4999 20.8333C10.2898 20.8333 8.17017 19.9554 6.60736 18.3926C5.04456 16.8298 4.16659 14.7101 4.16659 12.5Z"
                  fill="#DB0000"
                />
              </svg>
            </button>
            <p className={`${style.paragraph}`}>{quantity}</p>
            <button onClick={increaseCount}>
              <svg width="25" height="25" fill="none">
                <path
                  d="M11.4583 13.5417V16.6667C11.4583 16.9618 11.5583 17.2094 11.7583 17.4094C11.9583 17.6094 12.2055 17.709 12.4999 17.7083C12.7951 17.7083 13.0426 17.6083 13.2426 17.4083C13.4426 17.2083 13.5423 16.9611 13.5416 16.6667V13.5417H16.6666C16.9617 13.5417 17.2093 13.4417 17.4093 13.2417C17.6093 13.0417 17.7089 12.7945 17.7083 12.5C17.7083 12.2049 17.6083 11.9573 17.4083 11.7573C17.2083 11.5573 16.961 11.4576 16.6666 11.4583H13.5416V8.33334C13.5416 8.03821 13.4416 7.79064 13.2416 7.59064C13.0416 7.39064 12.7944 7.29098 12.4999 7.29168C12.2048 7.29168 11.9572 7.39168 11.7572 7.59168C11.5572 7.79168 11.4576 8.0389 11.4583 8.33334V11.4583H8.33325C8.03811 11.4583 7.79054 11.5583 7.59054 11.7583C7.39054 11.9583 7.29089 12.2056 7.29159 12.5C7.29159 12.7951 7.39159 13.0427 7.59159 13.2427C7.79159 13.4427 8.03881 13.5424 8.33325 13.5417H11.4583ZM12.4999 22.9167C11.0589 22.9167 9.70478 22.6431 8.43742 22.0958C7.17006 21.5486 6.06763 20.8066 5.13013 19.8698C4.19263 18.9323 3.45061 17.8299 2.90409 16.5625C2.35756 15.2951 2.08395 13.941 2.08325 12.5C2.08325 11.059 2.35686 9.70487 2.90409 8.43751C3.45131 7.17015 4.19332 6.06772 5.13013 5.13022C6.06763 4.19272 7.17006 3.4507 8.43742 2.90418C9.70478 2.35765 11.0589 2.08404 12.4999 2.08334C13.9409 2.08334 15.2951 2.35695 16.5624 2.90418C17.8298 3.4514 18.9322 4.19341 19.8697 5.13022C20.8072 6.06772 21.5496 7.17015 22.0968 8.43751C22.644 9.70487 22.9173 11.059 22.9166 12.5C22.9166 13.941 22.643 15.2951 22.0958 16.5625C21.5485 17.8299 20.8065 18.9323 19.8697 19.8698C18.9322 20.8073 17.8298 21.5497 16.5624 22.0969C15.2951 22.6441 13.9409 22.9174 12.4999 22.9167ZM12.4999 20.8333C14.8263 20.8333 16.7968 20.0261 18.4114 18.4115C20.026 16.7969 20.8333 14.8264 20.8333 12.5C20.8333 10.1736 20.026 8.20314 18.4114 6.58855C16.7968 4.97397 14.8263 4.16668 12.4999 4.16668C10.1735 4.16668 8.20304 4.97397 6.58846 6.58855C4.97388 8.20314 4.16659 10.1736 4.16659 12.5C4.16659 14.8264 4.97388 16.7969 6.58846 18.4115C8.20304 20.0261 10.1735 20.8333 12.4999 20.8333Z"
                  fill="black"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>
      <p>{fCurrency(item.price)}</p>
    </div>
  );
};

export default CheckoutItem;
